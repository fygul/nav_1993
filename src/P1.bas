10 CLEAR:PRINT"****** MARITIME PROGRAMS ******","1MS,2DR,3GC,4SUN,5MP,6SUNRISE,7ALT,8STAR,9SIGHT,10RM"
20 INPUT"1 TO 10";A:ON A GOTO 1000,2000,3000,4000,5000,6000,7000,8000,9000,2500:GOTO20
30 IF X>U THEN X=X-V ELSE IF X<-U THEN X=X+V
40 RETURN
50 U=180:V=360:RETURN
60 X=FIXX+FRACX/.6:RETURN
70 IF ABSFRACX*.6>=.5995THEN X=SGNX*(ABSFIXX+1)ELSE X=FIXX+FRACX*.6
80 IF DF=0THEN DF =1:DEFCHR$(252)="00A6C6000000"
90 X=ROUND(X,-4):Y=ABSFRACX*100:X=FIXX:X$=STR$(X)+CHR$(223)+MID$(STR$(FIXY),2)+CHR$(252)+MID$(STR$(FRACY*10),2):RETURN
100 X=180/PI*LNTAN(X/2+45)*60-23.4*SINX:RETURN
110 INPUT"LAT/FM";X:GOSUB60:L=X:INPUT"LONG/FM";X:GOSUB60:G=X:RETURN
120 INPUT"LAT/TO";X:GOSUB60:l=X:INPUT"LONG/TO";X:GOSUB60:g=X:RETURN
130 X=g-G:GOSUB30:RETURN
140 INPUT"LAT/X";X:GOSUB60:RETURN
150 INPUT"LONG/X";X:GOSUB60:RETURN
160 IF X=0THEN X=1E-8
165 RETURN
170 A$=INKEY$:IF A$=""THEN170ELSEBEEP:RETURN
180 X=L;GOSUB100:O=X:X=l:GOSUB100:P=X:RETURN
190 IF Y<0THEN Y=Y+V
200 RETURN
210 H=ASN(SINL*SIND+COSL*COSD*COSA):Z=ACS((SIND-SINL*SINH)/COSL/COSH):IF SINA>0 THEN Z=V-Z
220 RETURN

1000 CLEAR:PRINT"     ***MERCATOR SAILING***":GOSUB50
1010 INPUT"SEQUENT CALCULATION(Y/N)";S$:IF S$<>"Y"AND S$><"N"THEN1010
1020 GOSUB110
1030 GOSUB120:GOSUB180
1040 GOSUB130:D=X:Z=POL((P-O),D*60):GOSUB190
1050 IF L=1 THEN X=D*60*COSL ELSE X=(l-L)*60/COSY
1060 SETF1:PRINT"CO="Y;CHR$(223)"DIST="ABSX"'"
1070 IF ABSX<2000AND ABSD<20THEN1090ELSE INPUT"G.C SAILING(Y/N)";G$
1080 IF G$="Y"THEN3020ELSE IF G$<>"N"THEN1070
1090 IF S$="Y"THEN L=l:G=g:GOTO1030
1100 IF ABSCOSY<.7071THEN1130
1110 GOSUB140:GOSUB100:E=(X-O)*TANY/60+G
1120 PRINT"LONG/X="DMS$(E):GOTO1110
1130 GOSUB150:X=X-G:GOSUB30:M=X*60/TANY+O
1140 Q=(ATNEXP((M+23.4)*PI/10800-45)*2
1150 FOR S=1TO5:Q=(ATNEX((M+23.4*SINQ)*PI/10800)-45)*2:NEXT
1160 PRINT"LAT/X="DMS$(Q):GOTO1130

2000 CLEAR:PRINT"      ***DEAD RECKONING***":GOSUB50
2005 INPUT"SEQUENT TRIPS(Y/N)";Y$
2010 GOSUB110
2020 INPUT"Co";C,"DIST";d
2030 IF C=9THEN2100ELSE IF C=270THEN d=-d:GOTO2100
2040 X=(d*COSC)/60+L:l=X:GOSUB70:A$=X$:GOSUB180
2050 X=TANC*(P-O)/60+G
2060 GOSUB30:g=X:GOSUB70
2070 PRINT"LAT/TO="A$,"LONG/TO="X$
2090 IF Y$="Y"THEN L=l:G=g:GOTO2020ELSE2010
2100 X=L:GOSUB70:A$=X$
2110 X=d/COSL/60+G:GOTO2060

2500 CLEAR:PRINT"     ***RELATIVE MOTION***":GOSUB50:SETF1
2510 INPUT"Co";C,"Sp";S,"1st OBS HH.MMSS";H,"BRG";B,"DIST";D,"2nd OBS HH.MMSS"h,"BRG";b,"DIST";d:T=DEGRh-DEGRH
2520 Z=REC(D,B):A=X:E=Y:Z=REC(d,b):F=X:G=Y
2530 Z=POL(F-A,G-E):I=X/T:GOSUB190:J=Y
2540 Z=REC(S*T,C):Z=POL(F-A+X,G-E+Y):s=X/T:GOSUB190:c=Y
2550 PRINT"TC="c;CHR$(223)"  TS="s"Kt"
2560 K=V+b:IF K>=V THEN K=K-V
2570 IF J<K THEN J=V+J
2580 L=J-K:IF L>U THEN L=V-L
2590 IF L>90 THEN2620
2600 M=d*SINL:N=d*COSL/I:O=DEGRh+N:IF M<1THENBEEP
2610 PRINT"CPA="M"'","TCPA="N*60"MIN=="DMS$(O):GOSUB170
2620 IF K<c THEN K=K+V
2630 P=K-c:IF P>U THEN P=V-P:A$="R"ELSE A$="G"
2640 PRINT"ASPECT="A$;P;CHR$(223)
2650 IF B<C THEN B=B+V
2660 IF b<C THEN b=b+V
2670 P=B-C:Z=REC(D,P):Q=X:R=Y;IF P>U THEN P=V-P
2675 W=b-C:Z=REC(d,W):IF W>U THEN W=V-W
2680 IF SGNY<>SGNR THEN2720
2690 IF Y>Q OR W>P THEN2720
2700 Z=U-W-L:M=d*SINL/SINZ:N=d*SINW/SINZ/I:O=DEGRh*N
2710 PRINT"BCR="M"'","TBCR="N*60"MIN=="DMS$(O)
2720 INPUT"CHANGE Co/Sp(Y/N)";B$:IF B$<>"Y"THEN2510
2730 INPUT"N.Co";C,"N.Sp";S,"EXECUTE HH.MMSS";H
2740 d=(DEGRH-DEGRh)*I:h=H
2750 Z=REC(d,J):F=F+X:G=G+Y:Z=POL(F,G):d=X:GOSUB190:b=Y
2760 Z=REC(S*T,C):A=X:E=Y:Z=REC(s*T,c):Z=POL(X-A,Y-E):I=X/T:GOSUB190:J=Y
2770 Z=REC(I*T,J+U):Z=POL(F+X,G+Y):D=X:GOSUB190:B=Y:GOTO2560

3000 CLEAR:PRINT"    ***GREAT CIRCLE SAILING***":GOSUB50
3010 GOSUB110:GOSUB120
3020 X=L:GOSUB160:L=X:X=l:GOSUB160:l=X
3030 GOSUB130:GOSUB160:D=X
3040 d=ACS(SINL*SINl+COSL*COSl*COSD):IF SINd=0THEN d=d+1E-8
3050 GOSUB3510
3060 SETF1:PRINT"Co="C;CHR$(223)"DIST="d*60"'"
3070 X=ACS(SINc*COSL):IF X=0OR X=90THEN X=X-1E-8
3080 X=SGNL*X:Z=X:GOSUB70:V$=X$:X=-Z:GOSUB70:v$=X$
3090 GOSUB3680
3100 IFc<90THEN X=SGND*X ELSE X=-SGND*X
3110 X=G+X:GOSUB30:S=X:GOSUB70
3120 PRINT"LAT/V="V$"LONG/V="X$
3130 X=S+U:GOSUB30:s=X:GOSUB70
3140 PRINT"LAT/v="v$"LONG/v="X$
3150 GOSUB3650:r=10800-R
3160 a=c:z=Z:O=L:P=l:Q=D
3170 L=l:l=O:D=-D:GOSUB3510:GOSUB3660:GOSUB170
3180 PRINT"Cf="C;CHR$(223),"d/V="R"'  d/v="r"'"
3190 IF a<90THEN X=S-G ELSE X=s-G:W=1
3200 GOSUB30:IF ABSX>ABSQ THEN3240
3210 IF W=0THEN W$="SAME NAME AS"ELSE W$="CONTRARY NAME TO"
3220 INPUT"COMPOSITE SAILING(Y/N)";C$
3230 IF C$="Y"THEN3310ELSE IF C$<>"N"THEN3220
3240 GOSUB3690
3250 INPUT"LONG>>LAT;LAT>>LONG ONLY(Y/N)";O$
3260 IF O$<>"Y"AND O$<>"N"GOTO3250
3270 INPUT"1.LONG/X>>LAT 2.LAT/X>>LONG";L$
3280 IF L$<>"1"AND L$<>"2"GOTO3270
3290 IF L$="1"THEN GOSUB3560ELSE GOSUB3610
3300 IF O$="Y"THEN3290ELSE3270
3310 PRINT"LAT/MAX "W$" LAT/FM"
3320 INPUT"LAT/MAX";X:GOSUB60:Z=X
3330 IF ABSZ>ABSz THEN3320
3340 IF W=0AND SGNZ<>SGNO OR W=1AND SGNZ=SGNz THEN3310
3350 L=O:GOSUB3680:D=SGNQ*X:X=D+G:GOSUB30:I=X:GOSUB70:J$=X$
3360 l=Z:GOSUB3510:K=C
3370 L=P:GOSUB3680:D=-SGNQ*X:X=D+g:GOSUB30:i=X:GOSUB70:j$=X$:GOSUB3510:GOSUB3660
3380 PRINT"Ci="K;CHR(223)" Cf="C;CHR$(223)
3390 GOSUB3650:r=R:L=O:GOSUB3650
3400 X=i-I:GOSUB:p=ABSX*COSZ*60:d=R+p+r
3410 PRINT"D1="R"' D2="r"'","p="p"'":GOSUB170
3420 PRINT"TOTOL DIST="d
3430 PRINT"LONG/V="J$"LONG/v="j$:GOSUB3690
3440 X=I-G:GOSUB30:M=X:X=i-G:GOSUB30:N=X
3450 GOSUB150:E=X:X=E-G:GOSUB30:GOSUB160:D=X
3460 IF SGND<>SGNQ THEN PRINT"BEHIND DEPARTURE":GOTO3450
3470 IF ABSD>ABSM AND ABSD<ABSN THEN X=Z:GOSUB3600:GOTO3450
3480 X=I+U:GOSUB30:A=X:X=i+U:GOSUB30:B=X
3490 IF ABSD<ABSM THEN S=I:s=A ELSE S=i:s=B
3500 GOSUB3570:GOTO3450
3510 X=COSL*TANABSl:IF SGNL><SGNl THEN X=-X
3520 c=90-ATN((X=SINABSL*COSD)/SINABSD):C=c:IF c=90THEN c=c+1E-8
3530 IF L<0AND D>0THEN C=U-c ELSE IF D<0THEN C=U+c
3540 IF L>0AND D<0THEN C=V-c
3550 RETURN
3560 GOSUB150:E=X
3570 X=E-S:GOSUB30:T=X
3580 IF ABST<90THEN F=Z ELSE X=E-s:GOSUB30:T=X:F=-Z
3590 IF Z=0OR T=90THEN X=0ELSE X=ATN((COST*TANF):GOSUB70
3600 PRINT"LAT/X="X$:RETURN
3610 GOSUB140:IF X=0THEN T=90ELSE T=ACSABS(TANX/TANZ)
3620 IF SGNX=SGNZ THEN E=S ELSE E=s
3630 X=E+T:GOSUB30:GOSUUB70:F$=X$:X=E-T:GOSUB30:GOSUB70
3640 PRINT"LONG/X="F$"LONG/x"X$:RETURN
3650 R=ACS(SINL/SINZ)*60:RETURN
3660 C=C+U:IF C>V THEN C=C-V
3670 RETURN
3680 X=ACS(TANL/TANZ):RETURN
3690 IF S$="Y"THEN L=P:G=g:GOTO1030ELSE RETURN

4000 CLEAR:PRINT"DEC/GHA OF SUN"
4010 INPUT"YEAR";I,"MONTH";J,"DATE";K:A=I:B=J:C=K
4020 IF RS=1THEN6020
4030 INPUT"GMT(H.MS)";X:H=DEGRX
4040 GOTO4050
4050 GOSUB4300
4060 IF I<=100THEN I=1911+I
4070 IF J>=3GOTO4090
4080 I=I-1:J=12+J
4090 J=1+J:U=INT(365.25*I)+INT(30.6*J)+K-721067
4100 V=U/1461*360
4110 D=V*4:E=D*3:F=E-D:G=F*2
4120 D=D MOD360+FRACD:E=E MOD360+FRACE:F=F MOD360+FRACF:G=G MOD360+FRACG
4130 L=.379-22.892*COSD-.378*COSF-.149*COSE+4.151*SIND+.049*SINF+.085*SINE
4140 M=.44*COSD-3.45*COSF-.09*COSE-.14*COSG-7.35*SIND-9.3*SINF-.3*SINE-.17*SING
4150 T=T+1
4160 IF T=1THEN I=A:J=B:K=C+1:N=L:O=M:GOTO4060
4170 L=(L-N)/24*H+N:M=(M-O)/24*H+O:L=L+R
4180 X=L:GOSUB70:N$=X$
4190 IF P=2GOTO5130
4200 M=M*15/60:M=180+15*H+M
4210 IF M>=360THEN M=M-360
4220 M=M+Q:IF RS=1THEN6060
4230 IF P=1GOTO5040
4240 X=M:GOSUB70
4250 PRINT"GHA="X$" DEC="N$:GOSUB50
4260 INPUT"LAT";X:GOSUB60:Y=X:INPUT"LONG":X:GOSUB60:B=X:A=B+M:IF A>=0THEN4280
4270 A=A+V
4280 F=0:INPUT"Ho";X:GOSUB60:h=X
4290 D=L:L=Y:N=1:GOSUB7040
4300 G=4430:IF J=1THEN D=-6:E=-4:GOTO G
4310 IF J=2THEN D=2:E=18:GOTO G
4320 IF J=3THEN D=5:E=15:GOTO G
4330 IF J=4THEN D=6:E=15:GOTO G
4340 IF J=5THEN D=5:E=19:GOTO G
4350 IF J=6THEN D=-3:E=8:GOTO G
4360 IF J=7THEN D=-3:E=-5:GOTO G
4370 IF J=8THEN D=0:E=-9:GOTO G
4380 IF J=9THEN D=1:E=-14:GOTO G
4390 IF J=10THEN D=7:E=-24:GOTO G
4400 IF J=11THEN D=2:E=-12:GOTO G
4410 IF J=12THEN D=2:E=-7:GOTO G
4420 IF J=13THEN D=-6:E=-4
4430 F=F+1
4440 IF F=1THEN R=D:S=E:Q=J:J=J+1:GOTO4300
4450 J=Q:Q=(((D-R)/30*K)+R)/10^3/.6:R=(((E-S)/30*K+S)/10^3/.6:RETURN

5000 CLEAR:PRINT"MERIDIAN PASS"
5010 P=1:INPUT"YEAR";I=,"MONTH";J,"DATE";K:A=I:B=J:C=K
5020 DEFCHR$(254)="7050FE507000":DEFCHR$(255)="A2A4F8A4A200"
5030 INPUT"ZT(HR.MIN)";X:D=DEG(FIXX,FRACX*100):INPUT"ZD";W:H=D+W:GOTO4040
5040 INPUT"LAT";X:GOSUB60:D=X:INPUT"LONG";X:GOSUB60:E=X
5050 INPUT"COURSE";F,"SPEED";G
5060 L=M+E:IF L>=0THEN5080
5070 L=L+360:L=360-L:GOTO5090
5080 L=360-L:IF L<0THEN L=L+360
5090 M=L*60/((G*SINF/COSD)+900)
5100 N=H+M-W:H=H+W:I=A:J=B:K=C:T=0
5110 N1=FIXN:NN=FRACN*60:N2=FIXNN:N3=INT(FRACNN*60+.5)
5120 P=2:F=0:GOTO4040
5130 SETF0:PRINT" "CHR$(254)" "CHR$(255);N1"H"N2"M"N3"S":SETF3:PRINT"DEC="N$:GOTO5010

6000 CLEAR:RS=1
6010 PRINT"SUNRISE/SUNSET & TWILIGHT":GOTO4010
6020 INPUT"LAT";X:GOSUB60:LA=X
6030 INPUT"LONG";X:GOSUB60:LO=X
6040 INPUT"ZD";ZD:ZD=((-15*ZD)-LO)/15
6050 H=12:GOTO4050
6060 IF M<15THEN M=M+360
6070 D=(M-360)/15:DIM T(3),S(3),U(3)
6080 T(1)=ACS((COS90.8667-SINLA*SINL)/(COSLA*COSL))/15
6090 T(2)=ACS((COS96-SINLA*SINL)/(COSLA*COSL))/15
6100 T(3)=ACS((COS102-SINLA*SINL)/(COSLA*COSL))/15
6110 FOR I=1TO3
6120 S(I)=12-D-T(I)+ZD:X=S(I):GOSUB70:S(I)=X
6130 U(I)=12-D+T(I)+ZD:X=U(I):GOSUB70:U(I)=X
6140 NEXT I
6150 IF LA+L>=89.13THENS(1)=0:U(1)=0
6160 IF LA+L>=95.13THEN S(2)=0:U(2)=0
6170 IF LA+L>=101.13THEN S(3)=0:U(3)=0
6180 SETF2:PRINT:SUNRISE"S(3)CHR$(134)" "S(2)CHR$(134)" "S(1)CHR(227),"SUNSET"U(1)CHR$(229)U(2)CHR$(134)U(3)CHR$(134)
6190 GOTO6020

7000 CLEAR:PRINT"  ***ALTITUDE CALCULATION***":GOSUB50
7010 INPUT"LAT";B,"LONG";C,"MIN";M,"SEC";S,"GHA/0";I,"DEC/0";J,"GHA/1";K,"DEC/1";O,"Ho";X:GOSUB60:h=X
7020 X=B:GOSUB60:L=X:X=C:GOSUB60:G=X:X=I:GOSUB60:A=X:X=J:GOSUB60:D=X:X=K:GOSUB60:a=X:X=O:GOSUB60:IF a<A THEN a=a+V
7030 T=DEG(0,M,S):D=D+(X-D)*T:A=A+(a-A)*T+G
7040 GOSUB210:a=(h-H)*60:IF a<0THEN A$="A"ELST A$="T"
7050 SETF1:PRINT"Zn="Z;CHR$(223)"a="ABSa"'"A$:IF N=1THEN4000ELSE 7010

8000 CLEAR:PRINT"      ***STAR FINDING***":GOSUB50
8010 INPUT"LAT";L,"DEC/Hs";D,"LHA/Zn";X:GOSUB60:A=X
8020 X=L:GOSUB60:L=X:X=D:GOSUB60:D=X:GOSUB210:X=H:GOSUB70:H$=X$:X=Z:GOSUB70
8030 PRINT"Zn/LHA="X$,"Hc/DEC="H$
8040 INPUT"GHAr";r,"LONG";X:GOSUB60:G=X:X=r:GOSUB60:r=X:X=Z-r-G
8050 IF X<0THEN X=X+V:GOTO8050
8060 GOSUB70:PRINT"SHA="X$"DEC="H$:GOTO8000

9000 CLEAR:PRINT"     ***SIGHT REDUCTION***":T=10:P=1010:GOSUB50
9010 INPUT"NO. OF ASTRO-BODY";N,"IC(')";I,"HE-MTR";h,"TEMP/C-DEG";T,"PRESSURE/mb";P:DIP=.0293*SQRh
9020 DIM H(N),OB(N),Ho(N),O(N),G(N),D(N),L(N),Z(N),P(N)
9030 SETN:FOR M=1TO N:PRINTTAB(8)"**NO."M"SIGHT**","1:SUN  2:MOON    3:VENUS"
9040 INPUT"4:MARS 5:JUPITER 6:SATURN 7:STAR1 TO 7";J:INTJ:IF J>7OR J<1THEN9030
9050 INPUT"BASIC TIME";i,"OBS TIME";O,"GHA/0";b,"GHA/1";c:X=c:GOSUB60:g=X
9060 O(M)=DEGRO:x=O(M)-INTi:X=b:GOSUB60:G=X:IF g<G THEN g=g+V
9070 G(M)=G+x*(g-G):IF J=7THEN INPUT"SHA";k,"DEC";j:X=j:GOSUB60:D(M)=X:X=k:GOSUB60:G(M)=G(M)+X:GOTO9090
9080 INPUT"DEC/0";e,"DEC/1";f:X=f:GOSUB60:d=X:X=e:GOSUB60:D(M)=X+x*(d-X)
9090 INPUT"Hs";X:GOSUB60:Hs=X:H=Hs+I/60-DIP:R=.0167/TAN(H+7.31/(H+4.4)):IF T<>10OR P<>1010THEN R=R*.28*P/(T+273)
9100 IF J=1THEN PA=.0024*COSH:GOTO9120ELSE IF J>4THEN PA=0:GOTO9120
9110 INPUT"PARALLAX(HP)";HP:PA=HP/60*COSH:IF J=2AND PA*60>.2THEN OB(M)=1ELSE OB(M)=0
9120 IF J>2THEN S=0:GOTO9150ELSE INPUT"UPPER LIMB(Y/N)";U$
9130 IF J=2THEN S=.2724*HP/60ELSE INPUT"SEMI-DIA";SD:S=SD/60
9140 IF U$="Y"THEN S=-S
9150 Ho(M)=H-R+PA+S:H(M)=H:NEXT M
9160 INPUT"aLAT";La,"aLONG";Ga:X=La:GOSUB60:BF=X:X=Ga:GOSUB60:LF=X:IF N=1THEN F=O(1)ELSE INPUT"COURSE";Co,"SPEED";Sp,"UTC OF FIX";UF:F=DEGRUF
9170 a=0:B=0:C=0:d=0:E=0
9180 FOR M=1TO N
9190 L(M)=BF+(O(M)-F)*Sp/60*COSCo:G=LF+(O(M)-F)*Sp/60*SINCo/COSBF
9200 A=G(M)+G:L=L(M):D=D(M):GOSUB210:Z(M)=Z
9210 IF OB(M)=1THEN GOSUB9350:Ho(M)=Ho(M)+OB(M)
9220 P(M)=Ho(M)-H:IF BL=1THEN9240ELSE IF P(M)<0THEN P$="A"ELSE P$="T"
9225 IF M>1THEN GOSUB170
9230 SETF1:PRINTTAB(10)"NO."STR$(M)" SIGHT","a="ABSP(M)*60"'"P$"  Zn="Z(M);CHR$(223):IF N=1THENGOSUB170:GOTO9030
9235 IF M=N THEN PRINTTAB(11)"WAITING..."
9240 a=a+COSZ(M)^2:B=B+COSZ(M)*SINZ(M)
9250 C=C+SINZ(M)^2:d=d+P(M)*COSZ(M)
9260 E=E+P(M)*SINZ(M):NEXT M
9270 G=a*C-B^2
9280 BI=BF+(C*d-B*E)/G
9290 LI=LF+(a*E-B*d)/(G*COSBF)
9300 d=60*SQR((LI-LF)^2*COSBF^2+(BI-BF)^2)
9310 IF d>20THEN BF=BI:LF=LI:BL=1:GOTO9170ELSE BL=0
9320 X=BI:GOSUB70:BI$=X$:X=LI:GOSUB30:GOSUB70:BEEP
9330 PRINT"LAT="BI$,"LONG="X$:GOTO9160
9350 OB(M)=.0032*SIN(2*L(M))*COSZ(M)*SINH(M)-.0032*SINL(M)^2*COSH(M):RETURN
